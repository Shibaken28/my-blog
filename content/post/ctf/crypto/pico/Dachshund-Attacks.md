---
title: "picoGym - Dachshund Attacks"
date: 2022-05-12T12:23:40+09:00
tags: ["ctf","crypto","writeup","RSA","warmup"]
draft: false
---

## 概要
What if `d` is too small? Connect with `nc mercury.picoctf.net 36463`.

`nc`の内容
```
Welcome to my RSA challenge!
e: 103624928593399333320247354911447965825264533650971057319298353304002525474538065318852403512064726461174738193603428106904946146256008284823467554827152762569423678591697957603893052975071382627033744303434383276450203293997261442427812721673950613659922998042873117563940092261133781695925987694748389771773
n: 103910376399608681676353628245393162112102881564697113185356793045870832553995623283598951790023021111968530063336394918465350791877495297372970778126616798657973881785284282419987615918907108230154026098524221387899079560549181123756630931610952760466877749364644405065649111649647375141195338190881890507223
c: 30156643564028622673402640319494318578298751067165305755816959327117523569994850417236902775720256626905433978437761494210359833045159937002407287756120449107903682641130585193469930881110966314401974180644201866961482046321797331181951910878959864017526708803440621343824946268602601257095502437975774863711
```

## 解答
`e`が大きいということは，`d`が小さくなるので，Wiener's attackが有効．
[Wiener's attack 短い秘密鍵のRSA暗号への攻撃](https://cryptee.blogspot.com/2018/10/rsawieners-attack.html)を参考にさせて頂きました．

```python
from Crypto.Util.number import long_to_bytes

#Welcome to my RSA challenge!
e= 103624928593399333320247354911447965825264533650971057319298353304002525474538065318852403512064726461174738193603428106904946146256008284823467554827152762569423678591697957603893052975071382627033744303434383276450203293997261442427812721673950613659922998042873117563940092261133781695925987694748389771773
n= 103910376399608681676353628245393162112102881564697113185356793045870832553995623283598951790023021111968530063336394918465350791877495297372970778126616798657973881785284282419987615918907108230154026098524221387899079560549181123756630931610952760466877749364644405065649111649647375141195338190881890507223
c= 30156643564028622673402640319494318578298751067165305755816959327117523569994850417236902775720256626905433978437761494210359833045159937002407287756120449107903682641130585193469930881110966314401974180644201866961482046321797331181951910878959864017526708803440621343824946268602601257095502437975774863711


def f(a, b):
    q, r = a//b, a%b
    a0, a1 = 1, q
    b0, b1 = 0, 1
    while r:
       a, b = b, r
       q, r = a//b, a%b
       a0, a1 = a1, a0 + q*a1
       b0, b1 = b1, b0 + q*b1
       print(long_to_bytes(pow(c,b1,n)))

f(e,n)

```
このまま実行すると，正しくない`d`についてもたくさん出力されるので，`grep pico`などでフラグを探す．
```
python3 solve.py | grep pico
b'picoCTF{proving_wiener_2635457}'
```
